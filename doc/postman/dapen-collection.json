{
	"info": {
		"_postman_id": "dapen-collection",
		"name": "Dapen Collection",
		"description": "Complete API collection for Dapen IAM Service.\n\n## Health Endpoints\n- GET /health - Basic health check\n- GET /health/ready - Readiness check\n- GET /health/live - Liveness check\n\n## Registration Flow Overview\n```\nCREATED → PENDING_VERIFICATION → VERIFIED → COMPLETED\n```\n\n## Registration Endpoints\n1. POST /registrations - Initiate registration\n2. POST /registrations/{id}/verify-otp - Verify OTP\n3. POST /registrations/{id}/resend-otp - Resend OTP\n4. POST /registrations/{id}/complete - Complete registration\n5. GET /registrations/{id}/status - Check status",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
	},
	"item": [
		{
			"name": "Health",
			"item": [
				{
					"name": "Health Check",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status code is 200', function() {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test('Response has status field', function() {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData.status).to.eql('healthy');",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/api/v1/health",
							"host": ["{{base_url}}"],
							"path": ["api", "v1", "health"]
						},
						"description": "Basic health check endpoint."
					},
					"response": [
						{
							"name": "200 - Healthy",
							"originalRequest": {
								"method": "GET",
								"header": [],
								"url": {
									"raw": "{{base_url}}/api/v1/health",
									"host": ["{{base_url}}"],
									"path": ["api", "v1", "health"]
								}
							},
							"status": "OK",
							"code": 200,
							"_postman_previewlanguage": "json",
							"header": [{"key": "Content-Type", "value": "application/json"}],
							"body": "{\n    \"status\": \"healthy\",\n    \"timestamp\": \"2026-02-05T10:30:00Z\"\n}"
						}
					]
				},
				{
					"name": "Ready Check",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status code is 200', function() {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test('Service is ready', function() {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData.ready).to.be.true;",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/api/v1/health/ready",
							"host": ["{{base_url}}"],
							"path": ["api", "v1", "health", "ready"]
						},
						"description": "Readiness check for Kubernetes. Indicates if DB and Redis are connected."
					},
					"response": [
						{
							"name": "200 - Ready",
							"originalRequest": {
								"method": "GET",
								"header": [],
								"url": {
									"raw": "{{base_url}}/api/v1/health/ready",
									"host": ["{{base_url}}"],
									"path": ["api", "v1", "health", "ready"]
								}
							},
							"status": "OK",
							"code": 200,
							"_postman_previewlanguage": "json",
							"header": [{"key": "Content-Type", "value": "application/json"}],
							"body": "{\n    \"ready\": true\n}"
						},
						{
							"name": "503 - Not Ready",
							"originalRequest": {
								"method": "GET",
								"header": [],
								"url": {
									"raw": "{{base_url}}/api/v1/health/ready",
									"host": ["{{base_url}}"],
									"path": ["api", "v1", "health", "ready"]
								}
							},
							"status": "Service Unavailable",
							"code": 503,
							"_postman_previewlanguage": "json",
							"header": [{"key": "Content-Type", "value": "application/json"}],
							"body": "{\n    \"ready\": false,\n    \"error\": \"database connection failed\"\n}"
						}
					]
				},
				{
					"name": "Live Check",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status code is 200', function() {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test('Service is alive', function() {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData.alive).to.be.true;",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/api/v1/health/live",
							"host": ["{{base_url}}"],
							"path": ["api", "v1", "health", "live"]
						},
						"description": "Liveness check for Kubernetes restart decisions."
					},
					"response": [
						{
							"name": "200 - Alive",
							"originalRequest": {
								"method": "GET",
								"header": [],
								"url": {
									"raw": "{{base_url}}/api/v1/health/live",
									"host": ["{{base_url}}"],
									"path": ["api", "v1", "health", "live"]
								}
							},
							"status": "OK",
							"code": 200,
							"_postman_previewlanguage": "json",
							"header": [{"key": "Content-Type", "value": "application/json"}],
							"body": "{\n    \"alive\": true\n}"
						}
					]
				}
			],
			"description": "Health check endpoints for monitoring and Kubernetes probes."
		},
		{
			"name": "Registration",
			"item": [
				{
					"name": "Initiate Registration",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status code is 201', function() {",
									"    pm.response.to.have.status(201);",
									"});",
									"",
									"pm.test('Response has required fields', function() {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData.success).to.be.true;",
									"    pm.expect(jsonData.data.registration_id).to.exist;",
									"    pm.expect(jsonData.data.status).to.eql('PENDING_VERIFICATION');",
									"});",
									"",
									"if (pm.response.code === 201) {",
									"    var jsonData = pm.response.json();",
									"    pm.collectionVariables.set('registration_id', jsonData.data.registration_id);",
									"    pm.collectionVariables.set('registration_email', jsonData.data.email);",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{"key": "Content-Type", "value": "application/json"},
							{"key": "X-Tenant-ID", "value": "{{tenant_id}}"}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"email\": \"{{test_email}}\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/api/iam/v1/registrations",
							"host": ["{{base_url}}"],
							"path": ["api", "iam", "v1", "registrations"]
						},
						"description": "Initiates registration and sends OTP to email.\n\n**Headers:** X-Tenant-ID required\n**Body:** { email }"
					},
					"response": [
						{
							"name": "201 - Success",
							"originalRequest": {
								"method": "POST",
								"header": [
									{"key": "Content-Type", "value": "application/json"},
									{"key": "X-Tenant-ID", "value": "{{tenant_id}}"}
								],
								"body": {"mode": "raw", "raw": "{\n    \"email\": \"newuser@example.com\"\n}"},
								"url": {"raw": "{{base_url}}/api/iam/v1/registrations", "host": ["{{base_url}}"], "path": ["api", "iam", "v1", "registrations"]}
							},
							"status": "Created",
							"code": 201,
							"_postman_previewlanguage": "json",
							"header": [{"key": "Content-Type", "value": "application/json"}],
							"body": "{\n    \"success\": true,\n    \"data\": {\n        \"registration_id\": \"019462a1-7b3c-7def-8123-456789abcdef\",\n        \"email\": \"newuser@example.com\",\n        \"status\": \"PENDING_VERIFICATION\",\n        \"message\": \"Verification code sent to your email\",\n        \"expires_at\": \"2026-02-04T15:10:00Z\",\n        \"otp_config\": {\n            \"length\": 6,\n            \"expires_in_minutes\": 10,\n            \"max_attempts\": 5,\n            \"resend_cooldown_seconds\": 60,\n            \"max_resends\": 3\n        }\n    }\n}"
						},
						{
							"name": "400 - Invalid Email Format",
							"originalRequest": {
								"method": "POST",
								"header": [
									{"key": "Content-Type", "value": "application/json"},
									{"key": "X-Tenant-ID", "value": "{{tenant_id}}"}
								],
								"body": {"mode": "raw", "raw": "{\n    \"email\": \"invalid-email-format\"\n}"},
								"url": {"raw": "{{base_url}}/api/iam/v1/registrations", "host": ["{{base_url}}"], "path": ["api", "iam", "v1", "registrations"]}
							},
							"status": "Bad Request",
							"code": 400,
							"_postman_previewlanguage": "json",
							"header": [{"key": "Content-Type", "value": "application/json"}],
							"body": "{\n    \"success\": false,\n    \"error\": {\n        \"code\": \"INVALID_EMAIL\",\n        \"message\": \"Invalid email format\"\n    }\n}"
						},
						{
							"name": "400 - Empty Email",
							"originalRequest": {
								"method": "POST",
								"header": [
									{"key": "Content-Type", "value": "application/json"},
									{"key": "X-Tenant-ID", "value": "{{tenant_id}}"}
								],
								"body": {"mode": "raw", "raw": "{\n    \"email\": \"\"\n}"},
								"url": {"raw": "{{base_url}}/api/iam/v1/registrations", "host": ["{{base_url}}"], "path": ["api", "iam", "v1", "registrations"]}
							},
							"status": "Bad Request",
							"code": 400,
							"_postman_previewlanguage": "json",
							"header": [{"key": "Content-Type", "value": "application/json"}],
							"body": "{\n    \"success\": false,\n    \"error\": {\n        \"code\": \"INVALID_EMAIL\",\n        \"message\": \"Email is required\"\n    }\n}"
						},
						{
							"name": "400 - Missing Email Field",
							"originalRequest": {
								"method": "POST",
								"header": [
									{"key": "Content-Type", "value": "application/json"},
									{"key": "X-Tenant-ID", "value": "{{tenant_id}}"}
								],
								"body": {"mode": "raw", "raw": "{}"},
								"url": {"raw": "{{base_url}}/api/iam/v1/registrations", "host": ["{{base_url}}"], "path": ["api", "iam", "v1", "registrations"]}
							},
							"status": "Bad Request",
							"code": 400,
							"_postman_previewlanguage": "json",
							"header": [{"key": "Content-Type", "value": "application/json"}],
							"body": "{\n    \"success\": false,\n    \"error\": {\n        \"code\": \"INVALID_EMAIL\",\n        \"message\": \"Email is required\"\n    }\n}"
						},
						{
							"name": "400 - Email Too Long",
							"originalRequest": {
								"method": "POST",
								"header": [
									{"key": "Content-Type", "value": "application/json"},
									{"key": "X-Tenant-ID", "value": "{{tenant_id}}"}
								],
								"body": {"mode": "raw", "raw": "{\n    \"email\": \"verylongemailaddress...@example.com\"\n}"},
								"url": {"raw": "{{base_url}}/api/iam/v1/registrations", "host": ["{{base_url}}"], "path": ["api", "iam", "v1", "registrations"]}
							},
							"status": "Bad Request",
							"code": 400,
							"_postman_previewlanguage": "json",
							"header": [{"key": "Content-Type", "value": "application/json"}],
							"body": "{\n    \"success\": false,\n    \"error\": {\n        \"code\": \"INVALID_EMAIL\",\n        \"message\": \"Email must not exceed 255 characters\"\n    }\n}"
						},
						{
							"name": "400 - Invalid Tenant",
							"originalRequest": {
								"method": "POST",
								"header": [
									{"key": "Content-Type", "value": "application/json"},
									{"key": "X-Tenant-ID", "value": "00000000-0000-0000-0000-000000000000"}
								],
								"body": {"mode": "raw", "raw": "{\n    \"email\": \"user@example.com\"\n}"},
								"url": {"raw": "{{base_url}}/api/iam/v1/registrations", "host": ["{{base_url}}"], "path": ["api", "iam", "v1", "registrations"]}
							},
							"status": "Bad Request",
							"code": 400,
							"_postman_previewlanguage": "json",
							"header": [{"key": "Content-Type", "value": "application/json"}],
							"body": "{\n    \"success\": false,\n    \"error\": {\n        \"code\": \"INVALID_TENANT\",\n        \"message\": \"Tenant not found or inactive\"\n    }\n}"
						},
						{
							"name": "400 - Missing Tenant Header",
							"originalRequest": {
								"method": "POST",
								"header": [{"key": "Content-Type", "value": "application/json"}],
								"body": {"mode": "raw", "raw": "{\n    \"email\": \"user@example.com\"\n}"},
								"url": {"raw": "{{base_url}}/api/iam/v1/registrations", "host": ["{{base_url}}"], "path": ["api", "iam", "v1", "registrations"]}
							},
							"status": "Bad Request",
							"code": 400,
							"_postman_previewlanguage": "json",
							"header": [{"key": "Content-Type", "value": "application/json"}],
							"body": "{\n    \"success\": false,\n    \"error\": {\n        \"code\": \"INVALID_TENANT\",\n        \"message\": \"X-Tenant-ID header is required\"\n    }\n}"
						},
						{
							"name": "409 - Email Already Registered",
							"originalRequest": {
								"method": "POST",
								"header": [
									{"key": "Content-Type", "value": "application/json"},
									{"key": "X-Tenant-ID", "value": "{{tenant_id}}"}
								],
								"body": {"mode": "raw", "raw": "{\n    \"email\": \"existing@example.com\"\n}"},
								"url": {"raw": "{{base_url}}/api/iam/v1/registrations", "host": ["{{base_url}}"], "path": ["api", "iam", "v1", "registrations"]}
							},
							"status": "Conflict",
							"code": 409,
							"_postman_previewlanguage": "json",
							"header": [{"key": "Content-Type", "value": "application/json"}],
							"body": "{\n    \"success\": false,\n    \"error\": {\n        \"code\": \"EMAIL_EXISTS\",\n        \"message\": \"This email is already registered\",\n        \"details\": {\n            \"suggestion\": \"Try logging in or use password reset\"\n        }\n    }\n}"
						},
						{
							"name": "409 - Registration In Progress",
							"originalRequest": {
								"method": "POST",
								"header": [
									{"key": "Content-Type", "value": "application/json"},
									{"key": "X-Tenant-ID", "value": "{{tenant_id}}"}
								],
								"body": {"mode": "raw", "raw": "{\n    \"email\": \"pending@example.com\"\n}"},
								"url": {"raw": "{{base_url}}/api/iam/v1/registrations", "host": ["{{base_url}}"], "path": ["api", "iam", "v1", "registrations"]}
							},
							"status": "Conflict",
							"code": 409,
							"_postman_previewlanguage": "json",
							"header": [{"key": "Content-Type", "value": "application/json"}],
							"body": "{\n    \"success\": false,\n    \"error\": {\n        \"code\": \"REGISTRATION_IN_PROGRESS\",\n        \"message\": \"Active registration exists for this email\"\n    }\n}"
						},
						{
							"name": "429 - Rate Limit Exceeded",
							"originalRequest": {
								"method": "POST",
								"header": [
									{"key": "Content-Type", "value": "application/json"},
									{"key": "X-Tenant-ID", "value": "{{tenant_id}}"}
								],
								"body": {"mode": "raw", "raw": "{\n    \"email\": \"ratelimited@example.com\"\n}"},
								"url": {"raw": "{{base_url}}/api/iam/v1/registrations", "host": ["{{base_url}}"], "path": ["api", "iam", "v1", "registrations"]}
							},
							"status": "Too Many Requests",
							"code": 429,
							"_postman_previewlanguage": "json",
							"header": [
								{"key": "Content-Type", "value": "application/json"},
								{"key": "Retry-After", "value": "3600"}
							],
							"body": "{\n    \"success\": false,\n    \"error\": {\n        \"code\": \"RATE_LIMIT_EXCEEDED\",\n        \"message\": \"Too many registration attempts. Please try again later.\"\n    }\n}"
						}
					]
				},
				{
					"name": "Verify OTP",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status code is 200', function() {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test('Response has required fields', function() {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData.success).to.be.true;",
									"    pm.expect(jsonData.data.status).to.eql('VERIFIED');",
									"    pm.expect(jsonData.data.registration_token).to.exist;",
									"});",
									"",
									"if (pm.response.code === 200) {",
									"    var jsonData = pm.response.json();",
									"    pm.collectionVariables.set('registration_token', jsonData.data.registration_token);",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{"key": "Content-Type", "value": "application/json"},
							{"key": "X-Tenant-ID", "value": "{{tenant_id}}"}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"email\": \"{{registration_email}}\",\n    \"otp_code\": \"{{otp_code}}\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/api/iam/v1/registrations/{{registration_id}}/verify-otp",
							"host": ["{{base_url}}"],
							"path": ["api", "iam", "v1", "registrations", "{{registration_id}}", "verify-otp"]
						},
						"description": "Verifies OTP code sent to email.\n\n**Headers:** X-Tenant-ID required\n**Body:** { email, otp_code }"
					},
					"response": [
						{
							"name": "200 - OTP Verified",
							"originalRequest": {
								"method": "POST",
								"header": [
									{"key": "Content-Type", "value": "application/json"},
									{"key": "X-Tenant-ID", "value": "{{tenant_id}}"}
								],
								"body": {"mode": "raw", "raw": "{\n    \"email\": \"user@example.com\",\n    \"otp_code\": \"123456\"\n}"},
								"url": {"raw": "{{base_url}}/api/iam/v1/registrations/{{registration_id}}/verify-otp", "host": ["{{base_url}}"], "path": ["api", "iam", "v1", "registrations", "{{registration_id}}", "verify-otp"]}
							},
							"status": "OK",
							"code": 200,
							"_postman_previewlanguage": "json",
							"header": [{"key": "Content-Type", "value": "application/json"}],
							"body": "{\n    \"success\": true,\n    \"data\": {\n        \"registration_id\": \"019462a1-7b3c-7def-8123-456789abcdef\",\n        \"status\": \"VERIFIED\",\n        \"message\": \"Email verified successfully\",\n        \"registration_token\": \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...\",\n        \"token_expires_at\": \"2026-02-04T15:25:00Z\",\n        \"next_step\": {\n            \"action\": \"complete_registration\",\n            \"endpoint\": \"/api/iam/v1/registrations/{id}/complete\",\n            \"required_fields\": [\"password\", \"password_confirmation\", \"first_name\", \"last_name\"]\n        }\n    }\n}"
						},
						{
							"name": "400 - Invalid OTP Format (Not 6 Digits)",
							"originalRequest": {
								"method": "POST",
								"header": [
									{"key": "Content-Type", "value": "application/json"},
									{"key": "X-Tenant-ID", "value": "{{tenant_id}}"}
								],
								"body": {"mode": "raw", "raw": "{\n    \"email\": \"user@example.com\",\n    \"otp_code\": \"12345\"\n}"},
								"url": {"raw": "{{base_url}}/api/iam/v1/registrations/{{registration_id}}/verify-otp", "host": ["{{base_url}}"], "path": ["api", "iam", "v1", "registrations", "{{registration_id}}", "verify-otp"]}
							},
							"status": "Bad Request",
							"code": 400,
							"_postman_previewlanguage": "json",
							"header": [{"key": "Content-Type", "value": "application/json"}],
							"body": "{\n    \"success\": false,\n    \"error\": {\n        \"code\": \"INVALID_OTP_FORMAT\",\n        \"message\": \"OTP must be exactly 6 digits\"\n    }\n}"
						},
						{
							"name": "400 - Invalid OTP Format (Non-Numeric)",
							"originalRequest": {
								"method": "POST",
								"header": [
									{"key": "Content-Type", "value": "application/json"},
									{"key": "X-Tenant-ID", "value": "{{tenant_id}}"}
								],
								"body": {"mode": "raw", "raw": "{\n    \"email\": \"user@example.com\",\n    \"otp_code\": \"abc123\"\n}"},
								"url": {"raw": "{{base_url}}/api/iam/v1/registrations/{{registration_id}}/verify-otp", "host": ["{{base_url}}"], "path": ["api", "iam", "v1", "registrations", "{{registration_id}}", "verify-otp"]}
							},
							"status": "Bad Request",
							"code": 400,
							"_postman_previewlanguage": "json",
							"header": [{"key": "Content-Type", "value": "application/json"}],
							"body": "{\n    \"success\": false,\n    \"error\": {\n        \"code\": \"INVALID_OTP_FORMAT\",\n        \"message\": \"OTP must contain only numeric digits\"\n    }\n}"
						},
						{
							"name": "400 - Email Mismatch",
							"originalRequest": {
								"method": "POST",
								"header": [
									{"key": "Content-Type", "value": "application/json"},
									{"key": "X-Tenant-ID", "value": "{{tenant_id}}"}
								],
								"body": {"mode": "raw", "raw": "{\n    \"email\": \"different@example.com\",\n    \"otp_code\": \"123456\"\n}"},
								"url": {"raw": "{{base_url}}/api/iam/v1/registrations/{{registration_id}}/verify-otp", "host": ["{{base_url}}"], "path": ["api", "iam", "v1", "registrations", "{{registration_id}}", "verify-otp"]}
							},
							"status": "Bad Request",
							"code": 400,
							"_postman_previewlanguage": "json",
							"header": [{"key": "Content-Type", "value": "application/json"}],
							"body": "{\n    \"success\": false,\n    \"error\": {\n        \"code\": \"EMAIL_MISMATCH\",\n        \"message\": \"Email does not match registration\"\n    }\n}"
						},
						{
							"name": "400 - Missing OTP Code",
							"originalRequest": {
								"method": "POST",
								"header": [
									{"key": "Content-Type", "value": "application/json"},
									{"key": "X-Tenant-ID", "value": "{{tenant_id}}"}
								],
								"body": {"mode": "raw", "raw": "{\n    \"email\": \"user@example.com\"\n}"},
								"url": {"raw": "{{base_url}}/api/iam/v1/registrations/{{registration_id}}/verify-otp", "host": ["{{base_url}}"], "path": ["api", "iam", "v1", "registrations", "{{registration_id}}", "verify-otp"]}
							},
							"status": "Bad Request",
							"code": 400,
							"_postman_previewlanguage": "json",
							"header": [{"key": "Content-Type", "value": "application/json"}],
							"body": "{\n    \"success\": false,\n    \"error\": {\n        \"code\": \"INVALID_OTP_FORMAT\",\n        \"message\": \"OTP code is required\"\n    }\n}"
						},
						{
							"name": "401 - Invalid OTP (Wrong Code)",
							"originalRequest": {
								"method": "POST",
								"header": [
									{"key": "Content-Type", "value": "application/json"},
									{"key": "X-Tenant-ID", "value": "{{tenant_id}}"}
								],
								"body": {"mode": "raw", "raw": "{\n    \"email\": \"user@example.com\",\n    \"otp_code\": \"000000\"\n}"},
								"url": {"raw": "{{base_url}}/api/iam/v1/registrations/{{registration_id}}/verify-otp", "host": ["{{base_url}}"], "path": ["api", "iam", "v1", "registrations", "{{registration_id}}", "verify-otp"]}
							},
							"status": "Unauthorized",
							"code": 401,
							"_postman_previewlanguage": "json",
							"header": [{"key": "Content-Type", "value": "application/json"}],
							"body": "{\n    \"success\": false,\n    \"error\": {\n        \"code\": \"INVALID_OTP\",\n        \"message\": \"The verification code is incorrect\",\n        \"details\": {\n            \"attempts_remaining\": 4\n        }\n    }\n}"
						},
						{
							"name": "404 - Registration Not Found",
							"originalRequest": {
								"method": "POST",
								"header": [
									{"key": "Content-Type", "value": "application/json"},
									{"key": "X-Tenant-ID", "value": "{{tenant_id}}"}
								],
								"body": {"mode": "raw", "raw": "{\n    \"email\": \"user@example.com\",\n    \"otp_code\": \"123456\"\n}"},
								"url": {"raw": "{{base_url}}/api/iam/v1/registrations/invalid-id/verify-otp", "host": ["{{base_url}}"], "path": ["api", "iam", "v1", "registrations", "invalid-id", "verify-otp"]}
							},
							"status": "Not Found",
							"code": 404,
							"_postman_previewlanguage": "json",
							"header": [{"key": "Content-Type", "value": "application/json"}],
							"body": "{\n    \"success\": false,\n    \"error\": {\n        \"code\": \"REGISTRATION_NOT_FOUND\",\n        \"message\": \"Registration not found\"\n    }\n}"
						},
						{
							"name": "410 - Registration Expired",
							"originalRequest": {
								"method": "POST",
								"header": [
									{"key": "Content-Type", "value": "application/json"},
									{"key": "X-Tenant-ID", "value": "{{tenant_id}}"}
								],
								"body": {"mode": "raw", "raw": "{\n    \"email\": \"user@example.com\",\n    \"otp_code\": \"123456\"\n}"},
								"url": {"raw": "{{base_url}}/api/iam/v1/registrations/{{registration_id}}/verify-otp", "host": ["{{base_url}}"], "path": ["api", "iam", "v1", "registrations", "{{registration_id}}", "verify-otp"]}
							},
							"status": "Gone",
							"code": 410,
							"_postman_previewlanguage": "json",
							"header": [{"key": "Content-Type", "value": "application/json"}],
							"body": "{\n    \"success\": false,\n    \"error\": {\n        \"code\": \"REGISTRATION_EXPIRED\",\n        \"message\": \"Registration session has expired\"\n    }\n}"
						},
						{
							"name": "410 - OTP Expired",
							"originalRequest": {
								"method": "POST",
								"header": [
									{"key": "Content-Type", "value": "application/json"},
									{"key": "X-Tenant-ID", "value": "{{tenant_id}}"}
								],
								"body": {"mode": "raw", "raw": "{\n    \"email\": \"user@example.com\",\n    \"otp_code\": \"123456\"\n}"},
								"url": {"raw": "{{base_url}}/api/iam/v1/registrations/{{registration_id}}/verify-otp", "host": ["{{base_url}}"], "path": ["api", "iam", "v1", "registrations", "{{registration_id}}", "verify-otp"]}
							},
							"status": "Gone",
							"code": 410,
							"_postman_previewlanguage": "json",
							"header": [{"key": "Content-Type", "value": "application/json"}],
							"body": "{\n    \"success\": false,\n    \"error\": {\n        \"code\": \"OTP_EXPIRED\",\n        \"message\": \"OTP has expired, please request a new one\"\n    }\n}"
						},
						{
							"name": "429 - Max Attempts Exceeded",
							"originalRequest": {
								"method": "POST",
								"header": [
									{"key": "Content-Type", "value": "application/json"},
									{"key": "X-Tenant-ID", "value": "{{tenant_id}}"}
								],
								"body": {"mode": "raw", "raw": "{\n    \"email\": \"user@example.com\",\n    \"otp_code\": \"000000\"\n}"},
								"url": {"raw": "{{base_url}}/api/iam/v1/registrations/{{registration_id}}/verify-otp", "host": ["{{base_url}}"], "path": ["api", "iam", "v1", "registrations", "{{registration_id}}", "verify-otp"]}
							},
							"status": "Too Many Requests",
							"code": 429,
							"_postman_previewlanguage": "json",
							"header": [{"key": "Content-Type", "value": "application/json"}],
							"body": "{\n    \"success\": false,\n    \"error\": {\n        \"code\": \"MAX_ATTEMPTS_EXCEEDED\",\n        \"message\": \"Too many failed OTP attempts. Registration has been invalidated.\"\n    }\n}"
						}
					]
				},
				{
					"name": "Resend OTP",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status code is 200', function() {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test('Response has required fields', function() {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData.success).to.be.true;",
									"    pm.expect(jsonData.data.resends_remaining).to.exist;",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{"key": "Content-Type", "value": "application/json"},
							{"key": "X-Tenant-ID", "value": "{{tenant_id}}"}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"email\": \"{{registration_email}}\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/api/iam/v1/registrations/{{registration_id}}/resend-otp",
							"host": ["{{base_url}}"],
							"path": ["api", "iam", "v1", "registrations", "{{registration_id}}", "resend-otp"]
						},
						"description": "Resends OTP code. Previous OTP is invalidated.\n\n**Headers:** X-Tenant-ID required\n**Body:** { email }"
					},
					"response": [
						{
							"name": "200 - OTP Resent",
							"originalRequest": {
								"method": "POST",
								"header": [
									{"key": "Content-Type", "value": "application/json"},
									{"key": "X-Tenant-ID", "value": "{{tenant_id}}"}
								],
								"body": {"mode": "raw", "raw": "{\n    \"email\": \"user@example.com\"\n}"},
								"url": {"raw": "{{base_url}}/api/iam/v1/registrations/{{registration_id}}/resend-otp", "host": ["{{base_url}}"], "path": ["api", "iam", "v1", "registrations", "{{registration_id}}", "resend-otp"]}
							},
							"status": "OK",
							"code": 200,
							"_postman_previewlanguage": "json",
							"header": [{"key": "Content-Type", "value": "application/json"}],
							"body": "{\n    \"success\": true,\n    \"data\": {\n        \"registration_id\": \"019462a1-7b3c-7def-8123-456789abcdef\",\n        \"message\": \"New verification code sent to your email\",\n        \"expires_at\": \"2026-02-04T15:20:00Z\",\n        \"resends_remaining\": 2,\n        \"next_resend_available_at\": \"2026-02-04T15:11:00Z\"\n    }\n}"
						},
						{
							"name": "400 - Email Mismatch",
							"originalRequest": {
								"method": "POST",
								"header": [
									{"key": "Content-Type", "value": "application/json"},
									{"key": "X-Tenant-ID", "value": "{{tenant_id}}"}
								],
								"body": {"mode": "raw", "raw": "{\n    \"email\": \"different@example.com\"\n}"},
								"url": {"raw": "{{base_url}}/api/iam/v1/registrations/{{registration_id}}/resend-otp", "host": ["{{base_url}}"], "path": ["api", "iam", "v1", "registrations", "{{registration_id}}", "resend-otp"]}
							},
							"status": "Bad Request",
							"code": 400,
							"_postman_previewlanguage": "json",
							"header": [{"key": "Content-Type", "value": "application/json"}],
							"body": "{\n    \"success\": false,\n    \"error\": {\n        \"code\": \"EMAIL_MISMATCH\",\n        \"message\": \"Email does not match registration\"\n    }\n}"
						},
						{
							"name": "404 - Registration Not Found",
							"originalRequest": {
								"method": "POST",
								"header": [
									{"key": "Content-Type", "value": "application/json"},
									{"key": "X-Tenant-ID", "value": "{{tenant_id}}"}
								],
								"body": {"mode": "raw", "raw": "{\n    \"email\": \"user@example.com\"\n}"},
								"url": {"raw": "{{base_url}}/api/iam/v1/registrations/invalid-id/resend-otp", "host": ["{{base_url}}"], "path": ["api", "iam", "v1", "registrations", "invalid-id", "resend-otp"]}
							},
							"status": "Not Found",
							"code": 404,
							"_postman_previewlanguage": "json",
							"header": [{"key": "Content-Type", "value": "application/json"}],
							"body": "{\n    \"success\": false,\n    \"error\": {\n        \"code\": \"REGISTRATION_NOT_FOUND\",\n        \"message\": \"Registration not found\"\n    }\n}"
						},
						{
							"name": "409 - Already Verified",
							"originalRequest": {
								"method": "POST",
								"header": [
									{"key": "Content-Type", "value": "application/json"},
									{"key": "X-Tenant-ID", "value": "{{tenant_id}}"}
								],
								"body": {"mode": "raw", "raw": "{\n    \"email\": \"user@example.com\"\n}"},
								"url": {"raw": "{{base_url}}/api/iam/v1/registrations/{{registration_id}}/resend-otp", "host": ["{{base_url}}"], "path": ["api", "iam", "v1", "registrations", "{{registration_id}}", "resend-otp"]}
							},
							"status": "Conflict",
							"code": 409,
							"_postman_previewlanguage": "json",
							"header": [{"key": "Content-Type", "value": "application/json"}],
							"body": "{\n    \"success\": false,\n    \"error\": {\n        \"code\": \"ALREADY_VERIFIED\",\n        \"message\": \"Registration is already verified\"\n    }\n}"
						},
						{
							"name": "410 - Registration Expired",
							"originalRequest": {
								"method": "POST",
								"header": [
									{"key": "Content-Type", "value": "application/json"},
									{"key": "X-Tenant-ID", "value": "{{tenant_id}}"}
								],
								"body": {"mode": "raw", "raw": "{\n    \"email\": \"user@example.com\"\n}"},
								"url": {"raw": "{{base_url}}/api/iam/v1/registrations/{{registration_id}}/resend-otp", "host": ["{{base_url}}"], "path": ["api", "iam", "v1", "registrations", "{{registration_id}}", "resend-otp"]}
							},
							"status": "Gone",
							"code": 410,
							"_postman_previewlanguage": "json",
							"header": [{"key": "Content-Type", "value": "application/json"}],
							"body": "{\n    \"success\": false,\n    \"error\": {\n        \"code\": \"REGISTRATION_EXPIRED\",\n        \"message\": \"Registration session has expired\"\n    }\n}"
						},
						{
							"name": "429 - Resend Cooldown",
							"originalRequest": {
								"method": "POST",
								"header": [
									{"key": "Content-Type", "value": "application/json"},
									{"key": "X-Tenant-ID", "value": "{{tenant_id}}"}
								],
								"body": {"mode": "raw", "raw": "{\n    \"email\": \"user@example.com\"\n}"},
								"url": {"raw": "{{base_url}}/api/iam/v1/registrations/{{registration_id}}/resend-otp", "host": ["{{base_url}}"], "path": ["api", "iam", "v1", "registrations", "{{registration_id}}", "resend-otp"]}
							},
							"status": "Too Many Requests",
							"code": 429,
							"_postman_previewlanguage": "json",
							"header": [
								{"key": "Content-Type", "value": "application/json"},
								{"key": "Retry-After", "value": "45"}
							],
							"body": "{\n    \"success\": false,\n    \"error\": {\n        \"code\": \"RESEND_COOLDOWN\",\n        \"message\": \"Please wait before requesting another code\",\n        \"details\": {\n            \"retry_after_seconds\": 45,\n            \"retry_after\": \"2026-02-04T15:10:45Z\"\n        }\n    }\n}"
						},
						{
							"name": "429 - Max Resends Exceeded",
							"originalRequest": {
								"method": "POST",
								"header": [
									{"key": "Content-Type", "value": "application/json"},
									{"key": "X-Tenant-ID", "value": "{{tenant_id}}"}
								],
								"body": {"mode": "raw", "raw": "{\n    \"email\": \"user@example.com\"\n}"},
								"url": {"raw": "{{base_url}}/api/iam/v1/registrations/{{registration_id}}/resend-otp", "host": ["{{base_url}}"], "path": ["api", "iam", "v1", "registrations", "{{registration_id}}", "resend-otp"]}
							},
							"status": "Too Many Requests",
							"code": 429,
							"_postman_previewlanguage": "json",
							"header": [{"key": "Content-Type", "value": "application/json"}],
							"body": "{\n    \"success\": false,\n    \"error\": {\n        \"code\": \"MAX_RESENDS_EXCEEDED\",\n        \"message\": \"Maximum resend limit reached. Please start a new registration.\"\n    }\n}"
						}
					]
				},
				{
					"name": "Complete Registration",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status code is 201', function() {",
									"    pm.response.to.have.status(201);",
									"});",
									"",
									"pm.test('Response has required fields', function() {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData.success).to.be.true;",
									"    pm.expect(jsonData.data.user_id).to.exist;",
									"});",
									"",
									"if (pm.response.code === 201) {",
									"    var jsonData = pm.response.json();",
									"    pm.collectionVariables.set('user_id', jsonData.data.user_id);",
									"    if (jsonData.data.access_token) {",
									"        pm.collectionVariables.set('access_token', jsonData.data.access_token);",
									"        pm.collectionVariables.set('refresh_token', jsonData.data.refresh_token);",
									"    }",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{"key": "Content-Type", "value": "application/json"},
							{"key": "X-Tenant-ID", "value": "{{tenant_id}}"},
							{"key": "Authorization", "value": "Bearer {{registration_token}}"}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"password\": \"SecureP@ssw0rd!\",\n    \"password_confirmation\": \"SecureP@ssw0rd!\",\n    \"first_name\": \"John\",\n    \"last_name\": \"Doe\",\n    \"phone_number\": \"+6281234567890\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/api/iam/v1/registrations/{{registration_id}}/complete",
							"host": ["{{base_url}}"],
							"path": ["api", "iam", "v1", "registrations", "{{registration_id}}", "complete"]
						},
						"description": "Completes registration with password and profile.\n\n**Headers:** X-Tenant-ID, Authorization (Bearer token from verify)\n**Body:** { password, password_confirmation, first_name, last_name, phone_number? }"
					},
					"response": [
						{
							"name": "201 - Active User (Auto-Login)",
							"originalRequest": {
								"method": "POST",
								"header": [
									{"key": "Content-Type", "value": "application/json"},
									{"key": "X-Tenant-ID", "value": "{{tenant_id}}"},
									{"key": "Authorization", "value": "Bearer {{registration_token}}"}
								],
								"body": {"mode": "raw", "raw": "{\n    \"password\": \"SecureP@ssw0rd!\",\n    \"password_confirmation\": \"SecureP@ssw0rd!\",\n    \"first_name\": \"John\",\n    \"last_name\": \"Doe\",\n    \"phone_number\": \"+6281234567890\"\n}"},
								"url": {"raw": "{{base_url}}/api/iam/v1/registrations/{{registration_id}}/complete", "host": ["{{base_url}}"], "path": ["api", "iam", "v1", "registrations", "{{registration_id}}", "complete"]}
							},
							"status": "Created",
							"code": 201,
							"_postman_previewlanguage": "json",
							"header": [{"key": "Content-Type", "value": "application/json"}],
							"body": "{\n    \"success\": true,\n    \"data\": {\n        \"user_id\": \"019462a1-8888-7def-8123-456789abcdef\",\n        \"email\": \"user@example.com\",\n        \"status\": \"ACTIVE\",\n        \"message\": \"Registration completed successfully. You are now logged in.\",\n        \"profile\": {\n            \"first_name\": \"John\",\n            \"last_name\": \"Doe\"\n        },\n        \"access_token\": \"eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9...\",\n        \"refresh_token\": \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...\",\n        \"token_type\": \"Bearer\",\n        \"expires_in\": 900\n    }\n}"
						},
						{
							"name": "201 - Pending Approval (No Tokens)",
							"originalRequest": {
								"method": "POST",
								"header": [
									{"key": "Content-Type", "value": "application/json"},
									{"key": "X-Tenant-ID", "value": "{{tenant_with_approval_id}}"},
									{"key": "Authorization", "value": "Bearer {{registration_token}}"}
								],
								"body": {"mode": "raw", "raw": "{\n    \"password\": \"SecureP@ssw0rd!\",\n    \"password_confirmation\": \"SecureP@ssw0rd!\",\n    \"first_name\": \"Jane\",\n    \"last_name\": \"Smith\"\n}"},
								"url": {"raw": "{{base_url}}/api/iam/v1/registrations/{{registration_id}}/complete", "host": ["{{base_url}}"], "path": ["api", "iam", "v1", "registrations", "{{registration_id}}", "complete"]}
							},
							"status": "Created",
							"code": 201,
							"_postman_previewlanguage": "json",
							"header": [{"key": "Content-Type", "value": "application/json"}],
							"body": "{\n    \"success\": true,\n    \"data\": {\n        \"user_id\": \"019462a1-9999-7def-8123-456789abcdef\",\n        \"email\": \"user@example.com\",\n        \"status\": \"PENDING_APPROVAL\",\n        \"message\": \"Registration submitted. Your account is pending administrator approval.\",\n        \"profile\": {\n            \"first_name\": \"Jane\",\n            \"last_name\": \"Smith\"\n        }\n    }\n}"
						},
						{
							"name": "201 - Without Phone (Optional)",
							"originalRequest": {
								"method": "POST",
								"header": [
									{"key": "Content-Type", "value": "application/json"},
									{"key": "X-Tenant-ID", "value": "{{tenant_id}}"},
									{"key": "Authorization", "value": "Bearer {{registration_token}}"}
								],
								"body": {"mode": "raw", "raw": "{\n    \"password\": \"SecureP@ssw0rd!\",\n    \"password_confirmation\": \"SecureP@ssw0rd!\",\n    \"first_name\": \"John\",\n    \"last_name\": \"Doe\"\n}"},
								"url": {"raw": "{{base_url}}/api/iam/v1/registrations/{{registration_id}}/complete", "host": ["{{base_url}}"], "path": ["api", "iam", "v1", "registrations", "{{registration_id}}", "complete"]}
							},
							"status": "Created",
							"code": 201,
							"_postman_previewlanguage": "json",
							"header": [{"key": "Content-Type", "value": "application/json"}],
							"body": "{\n    \"success\": true,\n    \"data\": {\n        \"user_id\": \"019462a1-8888-7def-8123-456789abcdef\",\n        \"email\": \"user@example.com\",\n        \"status\": \"ACTIVE\",\n        \"message\": \"Registration completed successfully. You are now logged in.\",\n        \"profile\": {\n            \"first_name\": \"John\",\n            \"last_name\": \"Doe\"\n        },\n        \"access_token\": \"eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9...\",\n        \"refresh_token\": \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...\",\n        \"token_type\": \"Bearer\",\n        \"expires_in\": 900\n    }\n}"
						},
						{
							"name": "400 - Password Mismatch",
							"originalRequest": {
								"method": "POST",
								"header": [
									{"key": "Content-Type", "value": "application/json"},
									{"key": "X-Tenant-ID", "value": "{{tenant_id}}"},
									{"key": "Authorization", "value": "Bearer {{registration_token}}"}
								],
								"body": {"mode": "raw", "raw": "{\n    \"password\": \"SecureP@ssw0rd!\",\n    \"password_confirmation\": \"DifferentP@ssw0rd!\",\n    \"first_name\": \"John\",\n    \"last_name\": \"Doe\"\n}"},
								"url": {"raw": "{{base_url}}/api/iam/v1/registrations/{{registration_id}}/complete", "host": ["{{base_url}}"], "path": ["api", "iam", "v1", "registrations", "{{registration_id}}", "complete"]}
							},
							"status": "Bad Request",
							"code": 400,
							"_postman_previewlanguage": "json",
							"header": [{"key": "Content-Type", "value": "application/json"}],
							"body": "{\n    \"success\": false,\n    \"error\": {\n        \"code\": \"PASSWORD_MISMATCH\",\n        \"message\": \"Password and confirmation do not match\"\n    }\n}"
						},
						{
							"name": "400 - Password Too Weak",
							"originalRequest": {
								"method": "POST",
								"header": [
									{"key": "Content-Type", "value": "application/json"},
									{"key": "X-Tenant-ID", "value": "{{tenant_id}}"},
									{"key": "Authorization", "value": "Bearer {{registration_token}}"}
								],
								"body": {"mode": "raw", "raw": "{\n    \"password\": \"weakpassword123!\",\n    \"password_confirmation\": \"weakpassword123!\",\n    \"first_name\": \"John\",\n    \"last_name\": \"Doe\"\n}"},
								"url": {"raw": "{{base_url}}/api/iam/v1/registrations/{{registration_id}}/complete", "host": ["{{base_url}}"], "path": ["api", "iam", "v1", "registrations", "{{registration_id}}", "complete"]}
							},
							"status": "Bad Request",
							"code": 400,
							"_postman_previewlanguage": "json",
							"header": [{"key": "Content-Type", "value": "application/json"}],
							"body": "{\n    \"success\": false,\n    \"error\": {\n        \"code\": \"PASSWORD_TOO_WEAK\",\n        \"message\": \"Password does not meet security requirements\",\n        \"details\": {\n            \"policy\": {\n                \"min_length\": 8,\n                \"require_uppercase\": true,\n                \"require_lowercase\": true,\n                \"require_number\": true,\n                \"require_special\": true\n            },\n            \"violations\": [\"Must contain at least one uppercase letter\"]\n        }\n    }\n}"
						},
						{
							"name": "400 - Password Too Short",
							"originalRequest": {
								"method": "POST",
								"header": [
									{"key": "Content-Type", "value": "application/json"},
									{"key": "X-Tenant-ID", "value": "{{tenant_id}}"},
									{"key": "Authorization", "value": "Bearer {{registration_token}}"}
								],
								"body": {"mode": "raw", "raw": "{\n    \"password\": \"Short1!\",\n    \"password_confirmation\": \"Short1!\",\n    \"first_name\": \"John\",\n    \"last_name\": \"Doe\"\n}"},
								"url": {"raw": "{{base_url}}/api/iam/v1/registrations/{{registration_id}}/complete", "host": ["{{base_url}}"], "path": ["api", "iam", "v1", "registrations", "{{registration_id}}", "complete"]}
							},
							"status": "Bad Request",
							"code": 400,
							"_postman_previewlanguage": "json",
							"header": [{"key": "Content-Type", "value": "application/json"}],
							"body": "{\n    \"success\": false,\n    \"error\": {\n        \"code\": \"PASSWORD_TOO_WEAK\",\n        \"message\": \"Password does not meet security requirements\",\n        \"details\": {\n            \"violations\": [\"Must be at least 8 characters long\"]\n        }\n    }\n}"
						},
						{
							"name": "400 - Invalid Phone Format",
							"originalRequest": {
								"method": "POST",
								"header": [
									{"key": "Content-Type", "value": "application/json"},
									{"key": "X-Tenant-ID", "value": "{{tenant_id}}"},
									{"key": "Authorization", "value": "Bearer {{registration_token}}"}
								],
								"body": {"mode": "raw", "raw": "{\n    \"password\": \"SecureP@ssw0rd!\",\n    \"password_confirmation\": \"SecureP@ssw0rd!\",\n    \"first_name\": \"John\",\n    \"last_name\": \"Doe\",\n    \"phone_number\": \"invalid-phone\"\n}"},
								"url": {"raw": "{{base_url}}/api/iam/v1/registrations/{{registration_id}}/complete", "host": ["{{base_url}}"], "path": ["api", "iam", "v1", "registrations", "{{registration_id}}", "complete"]}
							},
							"status": "Bad Request",
							"code": 400,
							"_postman_previewlanguage": "json",
							"header": [{"key": "Content-Type", "value": "application/json"}],
							"body": "{\n    \"success\": false,\n    \"error\": {\n        \"code\": \"INVALID_PHONE_FORMAT\",\n        \"message\": \"Phone number must be in E.164 format (e.g., +6281234567890)\"\n    }\n}"
						},
						{
							"name": "400 - Missing First Name",
							"originalRequest": {
								"method": "POST",
								"header": [
									{"key": "Content-Type", "value": "application/json"},
									{"key": "X-Tenant-ID", "value": "{{tenant_id}}"},
									{"key": "Authorization", "value": "Bearer {{registration_token}}"}
								],
								"body": {"mode": "raw", "raw": "{\n    \"password\": \"SecureP@ssw0rd!\",\n    \"password_confirmation\": \"SecureP@ssw0rd!\",\n    \"last_name\": \"Doe\"\n}"},
								"url": {"raw": "{{base_url}}/api/iam/v1/registrations/{{registration_id}}/complete", "host": ["{{base_url}}"], "path": ["api", "iam", "v1", "registrations", "{{registration_id}}", "complete"]}
							},
							"status": "Bad Request",
							"code": 400,
							"_postman_previewlanguage": "json",
							"header": [{"key": "Content-Type", "value": "application/json"}],
							"body": "{\n    \"success\": false,\n    \"error\": {\n        \"code\": \"VALIDATION_ERROR\",\n        \"message\": \"first_name is required\"\n    }\n}"
						},
						{
							"name": "401 - Invalid Token",
							"originalRequest": {
								"method": "POST",
								"header": [
									{"key": "Content-Type", "value": "application/json"},
									{"key": "X-Tenant-ID", "value": "{{tenant_id}}"},
									{"key": "Authorization", "value": "Bearer invalid-token"}
								],
								"body": {"mode": "raw", "raw": "{\n    \"password\": \"SecureP@ssw0rd!\",\n    \"password_confirmation\": \"SecureP@ssw0rd!\",\n    \"first_name\": \"John\",\n    \"last_name\": \"Doe\"\n}"},
								"url": {"raw": "{{base_url}}/api/iam/v1/registrations/{{registration_id}}/complete", "host": ["{{base_url}}"], "path": ["api", "iam", "v1", "registrations", "{{registration_id}}", "complete"]}
							},
							"status": "Unauthorized",
							"code": 401,
							"_postman_previewlanguage": "json",
							"header": [{"key": "Content-Type", "value": "application/json"}],
							"body": "{\n    \"success\": false,\n    \"error\": {\n        \"code\": \"INVALID_TOKEN\",\n        \"message\": \"Registration token is invalid or expired\"\n    }\n}"
						},
						{
							"name": "401 - Missing Authorization",
							"originalRequest": {
								"method": "POST",
								"header": [
									{"key": "Content-Type", "value": "application/json"},
									{"key": "X-Tenant-ID", "value": "{{tenant_id}}"}
								],
								"body": {"mode": "raw", "raw": "{\n    \"password\": \"SecureP@ssw0rd!\",\n    \"password_confirmation\": \"SecureP@ssw0rd!\",\n    \"first_name\": \"John\",\n    \"last_name\": \"Doe\"\n}"},
								"url": {"raw": "{{base_url}}/api/iam/v1/registrations/{{registration_id}}/complete", "host": ["{{base_url}}"], "path": ["api", "iam", "v1", "registrations", "{{registration_id}}", "complete"]}
							},
							"status": "Unauthorized",
							"code": 401,
							"_postman_previewlanguage": "json",
							"header": [{"key": "Content-Type", "value": "application/json"}],
							"body": "{\n    \"success\": false,\n    \"error\": {\n        \"code\": \"INVALID_TOKEN\",\n        \"message\": \"Authorization header is required\"\n    }\n}"
						},
						{
							"name": "403 - Not Verified",
							"originalRequest": {
								"method": "POST",
								"header": [
									{"key": "Content-Type", "value": "application/json"},
									{"key": "X-Tenant-ID", "value": "{{tenant_id}}"},
									{"key": "Authorization", "value": "Bearer {{registration_token}}"}
								],
								"body": {"mode": "raw", "raw": "{\n    \"password\": \"SecureP@ssw0rd!\",\n    \"password_confirmation\": \"SecureP@ssw0rd!\",\n    \"first_name\": \"John\",\n    \"last_name\": \"Doe\"\n}"},
								"url": {"raw": "{{base_url}}/api/iam/v1/registrations/{{registration_id}}/complete", "host": ["{{base_url}}"], "path": ["api", "iam", "v1", "registrations", "{{registration_id}}", "complete"]}
							},
							"status": "Forbidden",
							"code": 403,
							"_postman_previewlanguage": "json",
							"header": [{"key": "Content-Type", "value": "application/json"}],
							"body": "{\n    \"success\": false,\n    \"error\": {\n        \"code\": \"NOT_VERIFIED\",\n        \"message\": \"Email has not been verified yet\"\n    }\n}"
						},
						{
							"name": "404 - Registration Not Found",
							"originalRequest": {
								"method": "POST",
								"header": [
									{"key": "Content-Type", "value": "application/json"},
									{"key": "X-Tenant-ID", "value": "{{tenant_id}}"},
									{"key": "Authorization", "value": "Bearer {{registration_token}}"}
								],
								"body": {"mode": "raw", "raw": "{\n    \"password\": \"SecureP@ssw0rd!\",\n    \"password_confirmation\": \"SecureP@ssw0rd!\",\n    \"first_name\": \"John\",\n    \"last_name\": \"Doe\"\n}"},
								"url": {"raw": "{{base_url}}/api/iam/v1/registrations/invalid-id/complete", "host": ["{{base_url}}"], "path": ["api", "iam", "v1", "registrations", "invalid-id", "complete"]}
							},
							"status": "Not Found",
							"code": 404,
							"_postman_previewlanguage": "json",
							"header": [{"key": "Content-Type", "value": "application/json"}],
							"body": "{\n    \"success\": false,\n    \"error\": {\n        \"code\": \"REGISTRATION_NOT_FOUND\",\n        \"message\": \"Registration not found\"\n    }\n}"
						},
						{
							"name": "409 - Email Exists (Race Condition)",
							"originalRequest": {
								"method": "POST",
								"header": [
									{"key": "Content-Type", "value": "application/json"},
									{"key": "X-Tenant-ID", "value": "{{tenant_id}}"},
									{"key": "Authorization", "value": "Bearer {{registration_token}}"}
								],
								"body": {"mode": "raw", "raw": "{\n    \"password\": \"SecureP@ssw0rd!\",\n    \"password_confirmation\": \"SecureP@ssw0rd!\",\n    \"first_name\": \"John\",\n    \"last_name\": \"Doe\"\n}"},
								"url": {"raw": "{{base_url}}/api/iam/v1/registrations/{{registration_id}}/complete", "host": ["{{base_url}}"], "path": ["api", "iam", "v1", "registrations", "{{registration_id}}", "complete"]}
							},
							"status": "Conflict",
							"code": 409,
							"_postman_previewlanguage": "json",
							"header": [{"key": "Content-Type", "value": "application/json"}],
							"body": "{\n    \"success\": false,\n    \"error\": {\n        \"code\": \"EMAIL_EXISTS\",\n        \"message\": \"This email is already registered\"\n    }\n}"
						},
						{
							"name": "410 - Registration Expired",
							"originalRequest": {
								"method": "POST",
								"header": [
									{"key": "Content-Type", "value": "application/json"},
									{"key": "X-Tenant-ID", "value": "{{tenant_id}}"},
									{"key": "Authorization", "value": "Bearer {{registration_token}}"}
								],
								"body": {"mode": "raw", "raw": "{\n    \"password\": \"SecureP@ssw0rd!\",\n    \"password_confirmation\": \"SecureP@ssw0rd!\",\n    \"first_name\": \"John\",\n    \"last_name\": \"Doe\"\n}"},
								"url": {"raw": "{{base_url}}/api/iam/v1/registrations/{{registration_id}}/complete", "host": ["{{base_url}}"], "path": ["api", "iam", "v1", "registrations", "{{registration_id}}", "complete"]}
							},
							"status": "Gone",
							"code": 410,
							"_postman_previewlanguage": "json",
							"header": [{"key": "Content-Type", "value": "application/json"}],
							"body": "{\n    \"success\": false,\n    \"error\": {\n        \"code\": \"REGISTRATION_EXPIRED\",\n        \"message\": \"Registration session has expired\"\n    }\n}"
						}
					]
				},
				{
					"name": "Check Registration Status",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status code is 200', function() {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test('Response has required fields', function() {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData.success).to.be.true;",
									"    pm.expect(jsonData.data.status).to.exist;",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{"key": "X-Tenant-ID", "value": "{{tenant_id}}"}
						],
						"url": {
							"raw": "{{base_url}}/api/iam/v1/registrations/{{registration_id}}/status?email={{registration_email}}",
							"host": ["{{base_url}}"],
							"path": ["api", "iam", "v1", "registrations", "{{registration_id}}", "status"],
							"query": [{"key": "email", "value": "{{registration_email}}"}]
						},
						"description": "Returns current registration status.\n\n**Headers:** X-Tenant-ID required\n**Query:** email (required)"
					},
					"response": [
						{
							"name": "200 - Pending Verification",
							"originalRequest": {
								"method": "GET",
								"header": [{"key": "X-Tenant-ID", "value": "{{tenant_id}}"}],
								"url": {"raw": "{{base_url}}/api/iam/v1/registrations/{{registration_id}}/status?email=user@example.com", "host": ["{{base_url}}"], "path": ["api", "iam", "v1", "registrations", "{{registration_id}}", "status"], "query": [{"key": "email", "value": "user@example.com"}]}
							},
							"status": "OK",
							"code": 200,
							"_postman_previewlanguage": "json",
							"header": [{"key": "Content-Type", "value": "application/json"}],
							"body": "{\n    \"success\": true,\n    \"data\": {\n        \"registration_id\": \"019462a1-7b3c-7def-8123-456789abcdef\",\n        \"email\": \"u***@example.com\",\n        \"status\": \"PENDING_VERIFICATION\",\n        \"expires_at\": \"2026-02-04T15:10:00Z\",\n        \"otp_attempts_remaining\": 5,\n        \"resends_remaining\": 3\n    }\n}"
						},
						{
							"name": "200 - Verified",
							"originalRequest": {
								"method": "GET",
								"header": [{"key": "X-Tenant-ID", "value": "{{tenant_id}}"}],
								"url": {"raw": "{{base_url}}/api/iam/v1/registrations/{{registration_id}}/status?email=user@example.com", "host": ["{{base_url}}"], "path": ["api", "iam", "v1", "registrations", "{{registration_id}}", "status"], "query": [{"key": "email", "value": "user@example.com"}]}
							},
							"status": "OK",
							"code": 200,
							"_postman_previewlanguage": "json",
							"header": [{"key": "Content-Type", "value": "application/json"}],
							"body": "{\n    \"success\": true,\n    \"data\": {\n        \"registration_id\": \"019462a1-7b3c-7def-8123-456789abcdef\",\n        \"email\": \"u***@example.com\",\n        \"status\": \"VERIFIED\",\n        \"expires_at\": \"2026-02-04T15:25:00Z\",\n        \"otp_attempts_remaining\": 0,\n        \"resends_remaining\": 2\n    }\n}"
						},
						{
							"name": "400 - Missing Email Parameter",
							"originalRequest": {
								"method": "GET",
								"header": [{"key": "X-Tenant-ID", "value": "{{tenant_id}}"}],
								"url": {"raw": "{{base_url}}/api/iam/v1/registrations/{{registration_id}}/status", "host": ["{{base_url}}"], "path": ["api", "iam", "v1", "registrations", "{{registration_id}}", "status"]}
							},
							"status": "Bad Request",
							"code": 400,
							"_postman_previewlanguage": "json",
							"header": [{"key": "Content-Type", "value": "application/json"}],
							"body": "{\n    \"success\": false,\n    \"error\": {\n        \"code\": \"VALIDATION_ERROR\",\n        \"message\": \"email query parameter is required\"\n    }\n}"
						},
						{
							"name": "400 - Email Mismatch",
							"originalRequest": {
								"method": "GET",
								"header": [{"key": "X-Tenant-ID", "value": "{{tenant_id}}"}],
								"url": {"raw": "{{base_url}}/api/iam/v1/registrations/{{registration_id}}/status?email=wrong@example.com", "host": ["{{base_url}}"], "path": ["api", "iam", "v1", "registrations", "{{registration_id}}", "status"], "query": [{"key": "email", "value": "wrong@example.com"}]}
							},
							"status": "Bad Request",
							"code": 400,
							"_postman_previewlanguage": "json",
							"header": [{"key": "Content-Type", "value": "application/json"}],
							"body": "{\n    \"success\": false,\n    \"error\": {\n        \"code\": \"EMAIL_MISMATCH\",\n        \"message\": \"Email does not match registration\"\n    }\n}"
						},
						{
							"name": "404 - Registration Not Found",
							"originalRequest": {
								"method": "GET",
								"header": [{"key": "X-Tenant-ID", "value": "{{tenant_id}}"}],
								"url": {"raw": "{{base_url}}/api/iam/v1/registrations/invalid-id/status?email=user@example.com", "host": ["{{base_url}}"], "path": ["api", "iam", "v1", "registrations", "invalid-id", "status"], "query": [{"key": "email", "value": "user@example.com"}]}
							},
							"status": "Not Found",
							"code": 404,
							"_postman_previewlanguage": "json",
							"header": [{"key": "Content-Type", "value": "application/json"}],
							"body": "{\n    \"success\": false,\n    \"error\": {\n        \"code\": \"REGISTRATION_NOT_FOUND\",\n        \"message\": \"Registration not found\"\n    }\n}"
						}
					]
				}
			],
			"description": "Registration flow endpoints: initiate, verify OTP, resend OTP, complete, check status."
		}
	],
	"event": [
		{
			"listen": "prerequest",
			"script": {
				"type": "text/javascript",
				"exec": [
					"if (!pm.collectionVariables.get('test_email') || pm.collectionVariables.get('test_email').includes('{{')) {",
					"    var timestamp = Date.now();",
					"    var uniqueEmail = 'test.user.' + timestamp + '@example.com';",
					"    pm.collectionVariables.set('test_email', uniqueEmail);",
					"}"
				]
			}
		},
		{
			"listen": "test",
			"script": {
				"type": "text/javascript",
				"exec": [
					"console.log('Response time: ' + pm.response.responseTime + 'ms');"
				]
			}
		}
	],
	"variable": [
		{"key": "base_url", "value": "http://localhost:8080", "type": "string"},
		{"key": "tenant_id", "value": "550e8400-e29b-41d4-a716-446655440000", "type": "string"},
		{"key": "tenant_with_approval_id", "value": "550e8400-e29b-41d4-a716-446655440001", "type": "string"},
		{"key": "test_email", "value": "", "type": "string"},
		{"key": "existing_user_email", "value": "existing@example.com", "type": "string"},
		{"key": "registration_id", "value": "", "type": "string"},
		{"key": "registration_email", "value": "", "type": "string"},
		{"key": "registration_token", "value": "", "type": "string"},
		{"key": "otp_code", "value": "123456", "type": "string"},
		{"key": "expired_registration_id", "value": "", "type": "string"},
		{"key": "unverified_registration_id", "value": "", "type": "string"},
		{"key": "user_id", "value": "", "type": "string"},
		{"key": "access_token", "value": "", "type": "string"},
		{"key": "refresh_token", "value": "", "type": "string"}
	]
}
